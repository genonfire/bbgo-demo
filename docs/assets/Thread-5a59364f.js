import{N as E}from"./NumberPagination-725c0352.js";import{u as $}from"./datetime-87f6df03.js";import{u as k}from"./user-12dc24db.js";import{_ as D}from"./plugin-vue_export-helper-c27b6911.js";import{V as w}from"./VContainer-24aec8ae.js";import{V as p}from"./VCol-b579b353.js";import{V as g}from"./forwardRefs-b452bb48.js";import{V as v}from"./VTooltip-8fc5b1ea.js";import{V as T}from"./VRow-3f802a33.js";import{V as R}from"./VTable-c4f0321d.js";import{r as y,o as m,c as b,w as s,g as d,a as n,b as f,t as r,d as a,M as C,e as c,f as I,F as A,a0 as N}from"./index-b7137ed4.js";import"./VSelect-4a3dc8da.js";import"./VTextField-83b93000.js";import"./VField-3c3f03bd.js";import"./VMenu-45d141ca.js";import"./ssrBoot-afe64649.js";import"./VOverlay-3da7fd39.js";import"./VCheckboxBtn-7d7bc7aa.js";import"./VChip-6dd36372.js";const S={setup(){const{formatDateOrTime:e}=$(),{username:l}=k();return{formatDateOrTime:e,username:l}},components:{NumberPagination:E},data(){return{forum:null,threads:[],pagination:null,pageSize:20,page:1,init:!1}},mounted(){this.$route.params.page&&(this.page=this.$route.params.page),this.getThreads(this.page,this.$route.query.q)},methods:{threadPage(e=1){this.$router.push({name:"thread.page",params:{forum:this.forum.name,page:e},query:{q:this.$route.query.q}})},getThreads(e=1,l=null){const i=this;let u=`${this.$api("THREAD_LIST").url}`;this.$axios({method:this.$api("THREAD_LIST").method,url:u.replace("{forum}",this.$route.params.forum)}).then(function(t){i.pagination=t.data.pagination,i.forum=t.data.data.forum,i.threads=t.data.data.threads,i.init=!0}).catch(function(t){i.$toast.error(i.$error(t,"THREAD_LIST"))})},newThread(){this.$router.push({name:"thread.write",params:{forum:this.$route.params.forum}})}}},x={class:"pl-2 text-body-2"},H={class:"text-center"},P={width:"120"},q={key:0,class:"font-weight-bold",style:{color:"#2384e2"}};function B(e,l,i,u,t,h){const _=y("router-link"),V=y("NumberPagination");return t.init?(m(),b(w,{key:0},{default:s(()=>[n(T,{style:{"border-bottom":"1px solid #DEE1E6FF"}},{default:s(()=>[n(p,{class:"text-h5 font-weight-bold py-2"},{default:s(()=>[n(_,{to:{name:"thread"}},{default:s(()=>[f(r(t.forum.title),1)]),_:1}),a("p",x,r(t.forum.description),1)]),_:1}),n(p,{cols:"3",class:"py-2 d-flex justify-end"},{default:s(()=>[n(g,{variant:"outlined","prepend-icon":"mdi-pencil-outline",color:"secondary",onClick:h.newThread,disabled:!t.forum.permissions.write},{default:s(()=>[f(r(e.$t("action.WRITE")),1)]),_:1},8,["onClick","disabled"]),e.$store.isStaff?(m(),b(v,{key:0,location:"bottom",text:e.$t("forum.THREAD_TRASH")},{activator:s(({props:o})=>[n(g,C(o,{icon:"mdi-trash-can-outline",density:"comfortable",variant:"text",color:"pale",class:"ml-1",onClick:l[0]||(l[0]=F=>e.$router.push({name:"thread.trash",params:{forum:t.forum.name}}))}),null,16)]),_:1},8,["text"])):d("",!0)]),_:1})]),_:1}),n(T,null,{default:s(()=>[n(p,null,{default:s(()=>[n(R,{density:"comfortable",hover:!0},{default:s(()=>[a("thead",null,[a("tr",null,[a("th",null,r(e.$t("common.PK")),1),a("th",H,r(e.$t("forum.THREAD_TITLE")),1),a("th",null,r(e.$t("forum.THREAD_USER")),1),a("th",P,r(e.$t("common.DATE")),1)])]),a("tbody",null,[(m(!0),c(A,null,I(t.threads,o=>(m(),c("tr",{key:o.id,class:N(o.is_pinned?"font-weight-bold":"")},[a("td",null,r(o.id),1),a("td",null,[n(_,{to:{name:"thread.read",params:{forum:t.forum.name,thread:o.id,title:o.title.replace(/ /g,"_")}}},{default:s(()=>[f(r(o.title)+" ",1),o.reply_count?(m(),c("span",q," ["+r(o.reply_count)+"] ",1)):d("",!0)]),_:2},1032,["to"])]),a("td",null,r(u.username(o)),1),a("td",null,r(u.formatDateOrTime(o.date_or_time)),1)],2))),128))])]),_:1})]),_:1})]),_:1}),n(V,{pagination:t.pagination,getItems:h.threadPage,page:parseInt(t.page)},null,8,["pagination","getItems","page"])]),_:1})):d("",!0)}const st=D(S,[["render",B],["__scopeId","data-v-a77db320"]]);export{st as default};
