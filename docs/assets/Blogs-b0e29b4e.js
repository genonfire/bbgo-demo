import{N as B}from"./NumberPagination-9c1fe51f.js";import{u as C}from"./datetime-87f6df03.js";import{T as k}from"./TagChips-fc75db3e.js";import{_ as L}from"./plugin-vue_export-helper-c27b6911.js";import{R as T,r as y,o as i,c,w as e,a as o,b as _,t as m,g as x,e as d,f as $,F as b,a0 as w,d as O}from"./index-9a7d77d1.js";import{V}from"./VContainer-5b7520f1.js";import{V as l}from"./VCol-c72717e7.js";import{V as I,f as N,B as P}from"./forwardRefs-601a00f7.js";import{V as h}from"./VRow-93a26ab0.js";import{V as A,a as q}from"./VChip-ec8b5f79.js";import{V as G}from"./VCard-70e41233.js";import"./VSelect-fde9b95b.js";import"./VTextField-c32c9752.js";import"./VField-28f70089.js";import"./VMenu-28f47fd6.js";import"./ssrBoot-dfd69665.js";import"./VOverlay-bfd1bd36.js";import"./VCheckboxBtn-b9ccac59.js";const S={setup(){const{formatDate:a}=C(),{smAndUp:r}=T();return{formatDate:a,smAndUp:r}},components:{NumberPagination:B,TagChips:k},data(){return{blogOption:this.$store.getBlogOption,blogs:[],pagination:null,pageSize:10,page:1,category:"",tag:"",init:!1}},computed:{permissionWrite(){return this.blogOption.option.permission_write=="staff"?this.$store.isStaff:this.blogOption.option.permission_write=="member"?this.$store.isApproved:this.blogOption.option.permission_write=="all"}},mounted(){this.blogOption||this.getBlogOption(),this.$route.params.page&&(this.page=this.$route.params.page),this.$route.query.tag&&(this.tag=this.$route.query.tag),this.$route.query.category&&(this.category=this.$route.query.category),this.getBlogs(this.page,this.$route.query.q)},methods:{getBlogOption(){const a=this;this.$axios({method:this.$api("BLOG_OPTION").method,url:this.$api("BLOG_OPTION").url}).then(function(r){a.blogOption=r.data.data,a.init=!0}).catch(function(r){a.$toast.error(a.$error(r,"BLOG_OPTION"))})},blogPage(a=1){this.$router.push({name:"blogs.page",params:{page:a},query:{q:this.$route.query.q,category:this.$route.query.category,tag:this.$route.query.tag}})},getBlogs(a=1,r=null){const u=this;let n="";r&&(n="&q="+r);let s="";this.tag&&this.tag!=""&&(s="&tag="+this.tag);let p="category=";this.category&&this.category!=""&&(p="category="+this.category);let f=`${this.$api("BLOG_LIST").url}?${p}${s}${n}`;this.$axios({method:this.$api("BLOG_LIST").method,url:f}).then(function(g){u.pagination=g.data.pagination,u.blogs=g.data.data,u.init=!0}).catch(function(g){u.$toast.error(u.$error(g,"BLOG_LIST"))})},selectCategory(a){this.category!=a&&(this.category=a,this.$router.push({name:"blogs",query:{q:this.$route.query.q,category:this.category,tag:this.$route.query.tag}}))}}},U={key:0,class:"floating-like"},D={class:"text-body-1"},R={class:"text-body-2",style:{color:"grey"}},E={key:0,class:"mt-2 d-flex"};function F(a,r,u,n,s,p){const f=y("TagChips"),g=y("router-link"),v=y("NumberPagination");return s.init?(i(),c(V,{key:0},{default:e(()=>[o(h,null,{default:e(()=>[o(l),o(l,{class:"text-center text-h4 font-weight-bold py-2"},{default:e(()=>[_(m(s.blogOption.title),1)]),_:1}),o(l,{class:"text-right py-2"},{default:e(()=>[p.permissionWrite?(i(),c(I,{key:0,variant:"outlined","prepend-icon":"mdi-pencil-outline",color:"secondary",onClick:r[0]||(r[0]=t=>a.$router.push({name:"blog.write"}))},{default:e(()=>[_(m(a.$t("action.WRITE")),1)]),_:1})):x("",!0)]),_:1})]),_:1}),o(A,{modelValue:s.category,"onUpdate:modelValue":r[1]||(r[1]=t=>s.category=t),variant:"text",class:"text-secondary","selected-class":"bg-secondary",mandatory:""},{default:e(()=>[o(h,{class:"mx-8 my-2 text-center"},{default:e(()=>[(i(!0),d(b,null,$(["",...s.blogOption.category],t=>(i(),c(l,null,{default:e(()=>[(i(),c(q,{key:t,text:t||a.$t("blog.CATEGORY_ALL"),value:t,class:"px-4",onClick:W=>p.selectCategory(t)},null,8,["text","value","onClick"]))]),_:2},1024))),256))]),_:1})]),_:1},8,["modelValue"]),o(V,null,{default:e(()=>[o(h,null,{default:e(()=>[o(l,{class:"pa-0"},{default:e(()=>[(i(!0),d(b,null,$(s.blogs,t=>(i(),c(G,{key:t.id,class:"my-5 pa-0",variant:"flat",hover:""},{default:e(()=>[o(g,{to:{name:"blog.read",params:{blog:t.id,title:t.title.replace(/ /g,"_")}}},{default:e(()=>[o(h,null,{default:e(()=>[o(l,{cols:"3",class:"px-3 py-2"},{default:e(()=>[o(N,{src:t.image?t.image.file:"/image-outline.png",width:n.smAndUp?240:120,height:n.smAndUp?240:120},{default:e(()=>[n.smAndUp?(i(),d("span",U,m(t.like),1)):x("",!0)]),_:2},1032,["src","width","height"])]),_:2},1024),o(l,{cols:"9",class:w(["pl-8 pr-4 py-5 font-weight-medium d-flex flex-column justify-start",n.smAndUp?"text-h4":"text-h6"])},{default:e(()=>[O("div",D,[o(q,{variant:"text",color:"secondary",class:"pl-0 text-body-1 font-weight-medium"},{default:e(()=>[_(m(t.category),1)]),_:2},1024),O("span",R,m(n.formatDate(t.created_at)),1)]),O("div",null,m(t.title),1),t.tags?(i(),d("div",E,[o(f,{tags:t.tags,color:"pale",label:!0},null,8,["tags"])])):x("",!0)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),o(v,{pagination:s.pagination,getItems:p.blogPage,page:parseInt(s.page)},null,8,["pagination","getItems","page"])]),_:1})):(i(),c(P,{key:1,indeterminate:"",height:4,color:"secondary"}))}const lt=L(S,[["render",F],["__scopeId","data-v-828be81a"]]);export{lt as default};
