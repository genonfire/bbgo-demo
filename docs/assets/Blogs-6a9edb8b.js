import{N as B}from"./NumberPagination-725c0352.js";import{u as C}from"./datetime-87f6df03.js";import{T as k}from"./TagChips-2898481e.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import{R as T,r as y,o as i,c,w as e,a,b as _,t as m,g as O,e as d,f as b,F as $,a0 as w,d as x}from"./index-b7137ed4.js";import{V}from"./VContainer-24aec8ae.js";import{V as l}from"./VCol-b579b353.js";import{V as I,f as N,B as P}from"./forwardRefs-b452bb48.js";import{V as h}from"./VRow-3f802a33.js";import{V as A,a as q}from"./VChip-6dd36372.js";import{V as G}from"./VCard-4331e0a1.js";import"./VSelect-4a3dc8da.js";import"./VTextField-83b93000.js";import"./VField-3c3f03bd.js";import"./VMenu-45d141ca.js";import"./ssrBoot-afe64649.js";import"./VOverlay-3da7fd39.js";import"./VCheckboxBtn-7d7bc7aa.js";const S={setup(){const{formatDate:o}=C(),{smAndUp:s}=T();return{formatDate:o,smAndUp:s}},components:{NumberPagination:B,TagChips:k},data(){return{blogOption:this.$store.getBlogOption,blogs:[],pagination:null,pageSize:10,page:1,category:"",tag:"",init:!1}},computed:{permissionWrite(){return this.blogOption.option.permission_write=="staff"?this.$store.isStaff:this.blogOption.option.permission_write=="member"?this.$store.isApproved:this.blogOption.option.permission_write=="all"}},mounted(){console.log(this.blogOption),this.blogOption||this.getBlogOption(),this.$route.params.page&&(this.page=this.$route.params.page),this.$route.query.tag&&(this.tag=this.$route.query.tag),this.$route.query.category&&(this.category=this.$route.query.category),this.getBlogs(this.page,this.$route.query.q)},methods:{getBlogOption(){const o=this;this.$axios({method:this.$api("BLOG_OPTION").method,url:this.$api("BLOG_OPTION").url}).then(function(s){o.blogOption=s.data.data,o.init=!0,console.log(o.blogOption)}).catch(function(s){o.$toast.error(o.$error(s,"BLOG_OPTION"))})},blogPage(o=1){this.$router.push({name:"blogs.page",params:{page:o},query:{q:this.$route.query.q,category:this.$route.query.category,tag:this.$route.query.tag}})},getBlogs(o=1,s=null){const g=this;let n="";s&&(n="&q="+s);let r="";this.tag&&this.tag!=""&&(r="&tag="+this.tag);let p="category=";this.category&&this.category!=""&&(p="category="+this.category);let f=`${this.$api("BLOG_LIST").url}?${p}${r}${n}`;this.$axios({method:this.$api("BLOG_LIST").method,url:f}).then(function(u){g.pagination=u.data.pagination,g.blogs=u.data.data,g.init=!0}).catch(function(u){g.$toast.error(g.$error(u,"BLOG_LIST"))})},selectCategory(o){this.category!=o&&(this.category=o,this.$router.push({name:"blogs",query:{q:this.$route.query.q,category:this.category,tag:this.$route.query.tag}}))}}},U={key:0,class:"floating-like"},D={class:"text-body-1"},R={class:"text-body-2",style:{color:"grey"}},E={key:0,class:"mt-2 d-flex"};function F(o,s,g,n,r,p){const f=y("TagChips"),u=y("router-link"),v=y("NumberPagination");return r.init?(i(),c(V,{key:0},{default:e(()=>[a(h,null,{default:e(()=>[a(l),a(l,{class:"text-center text-h4 font-weight-bold py-2"},{default:e(()=>[_(m(r.blogOption.title),1)]),_:1}),a(l,{class:"text-right py-2"},{default:e(()=>[p.permissionWrite?(i(),c(I,{key:0,variant:"outlined","prepend-icon":"mdi-pencil-outline",color:"secondary",onClick:s[0]||(s[0]=t=>o.$router.push({name:"blog.write"}))},{default:e(()=>[_(m(o.$t("action.WRITE")),1)]),_:1})):O("",!0)]),_:1})]),_:1}),a(A,{modelValue:r.category,"onUpdate:modelValue":s[1]||(s[1]=t=>r.category=t),variant:"text",class:"text-secondary","selected-class":"bg-secondary",mandatory:""},{default:e(()=>[a(h,{class:"mx-8 my-2 text-center"},{default:e(()=>[(i(!0),d($,null,b(["",...r.blogOption.category],t=>(i(),c(l,null,{default:e(()=>[(i(),c(q,{key:t,text:t||o.$t("blog.CATEGORY_ALL"),value:t,class:"px-4",onClick:W=>p.selectCategory(t)},null,8,["text","value","onClick"]))]),_:2},1024))),256))]),_:1})]),_:1},8,["modelValue"]),a(V,null,{default:e(()=>[a(h,null,{default:e(()=>[a(l,{class:"pa-0"},{default:e(()=>[(i(!0),d($,null,b(r.blogs,t=>(i(),c(G,{key:t.id,class:"my-5 pa-0",variant:"flat",hover:""},{default:e(()=>[a(u,{to:{name:"blog.read",params:{blog:t.id,title:t.title.replace(/ /g,"_")}}},{default:e(()=>[a(h,null,{default:e(()=>[a(l,{cols:"3",class:"px-3 py-2"},{default:e(()=>[a(N,{src:t.image?t.image.file:"/image-outline.png",width:n.smAndUp?240:120,height:n.smAndUp?240:120},{default:e(()=>[n.smAndUp?(i(),d("span",U,m(t.like),1)):O("",!0)]),_:2},1032,["src","width","height"])]),_:2},1024),a(l,{cols:"9",class:w(["pl-8 pr-4 py-5 font-weight-medium d-flex flex-column justify-start",n.smAndUp?"text-h4":"text-h6"])},{default:e(()=>[x("div",D,[a(q,{variant:"text",color:"secondary",class:"pl-0 text-body-1 font-weight-medium"},{default:e(()=>[_(m(t.category),1)]),_:2},1024),x("span",R,m(n.formatDate(t.created_at)),1)]),x("div",null,m(t.title),1),t.tags?(i(),d("div",E,[a(f,{tags:t.tags,color:"pale",label:!0},null,8,["tags"])])):O("",!0)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),a(v,{pagination:r.pagination,getItems:p.blogPage,page:parseInt(r.page)},null,8,["pagination","getItems","page"])]),_:1})):(i(),c(P,{key:1,indeterminate:"",height:4,color:"secondary"}))}const lt=L(S,[["render",F],["__scopeId","data-v-55cdbfc5"]]);export{lt as default};
