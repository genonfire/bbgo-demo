import{N as I}from"./NumberPagination-b7d36ddc.js";import{A as N}from"./ActiveSelector-c1a629e0.js";import{u as b}from"./rules-d6ec9447.js";import{u as F}from"./datetime-87f6df03.js";import{u as L}from"./download-11e7ad69.js";import{r as D,o as m,c as h,w as o,a as t,e as g,t as i,b as f,V as w,d as n,f as R,F as M,M as P,g as U}from"./index-19cdb70b.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import{V as x}from"./VContainer-f8abdc09.js";import{V as d}from"./VCol-e00bcbf1.js";import{V,f as z,a as y,s as $}from"./forwardRefs-924807e8.js";import{V as p}from"./VRow-19d851c3.js";import{V as q,a as A}from"./VTabs-f5dd1bab.js";import{V as _}from"./VTextField-61eec21d.js";import{V as B}from"./VTable-33df0de0.js";import{V as T}from"./VDialog-43c5c180.js";import{a as K,V as v,b as j}from"./VCard-4cfd500e.js";import{V as G}from"./VForm-ca47194b.js";import{V as H}from"./VFileInput-e44d8e73.js";import{V as S}from"./VSwitch-0492887f.js";import{V as C}from"./VSpacer-7e748533.js";import"./VSelect-05023c47.js";import"./VMenu-65ab0cc9.js";import"./ssrBoot-cad1a3e9.js";import"./VOverlay-545b978e.js";import"./VField-53be84f4.js";import"./VCheckboxBtn-1c9dfc3d.js";import"./VChip-4e03b0ad.js";const J={setup(){const{rules:e}=b(),{formatDateTime:l,formatDate:r}=F();return{formatDateTime:l,formatDate:r,rules:e}},components:{NumberPagination:I,ActiveSelector:N},data(){return{dialog:!1,deleteDialog:!1,users:[],user:null,file:null,pagination:null,pageSize:20,active:null,search:null,staff:!1,validation:!1,init:!1}},mounted(){this.getUsers()},methods:{getUsers(e=1){const l=this;let r="ADMIN_USERS";this.staff&&(r="ADMIN_STAFFS");let u="";this.search&&(u="&q="+this.search);let s="";this.active&&(s="&active="+this.active);let c=`${this.$api(r).url}?page_size=${this.pageSize}&page=${e}${s}${u}`;this.$axios({method:this.$api(r).method,url:c}).then(function(E){l.pagination=E.data.pagination,l.users=E.data.data,l.init=!0}).catch(function(E){l.$toast.error(l.$error(E,r))})},onTabUpdate(){this.active=null,this.search=null,this.getUsers()},onEnter(){this.getUsers()},exportExcel(){const e=this.$api("ADMIN_EXPORT_USERS");L(e.method,e.url,"users")},getUser(e){const l=this;let r="ADMIN_USER";this.staff&&(r="ADMIN_STAFF"),this.$axios({method:this.$api(r).method,url:this.$api(r).url.replace("{pk}",e)}).then(function(u){l.user=u.data.data}).catch(function(u){l.$toast.error(l.$error(u,r))})},editUser(e){this.getUser(e.id),this.dialog=!0},deleteUser(){var e=this;let l="ADMIN_DELETE_USER";this.staff&&(l="ADMIN_DELETE_STAFF"),this.$axios({method:this.$api(l).method,url:this.$api(l).url.replace("{pk}",this.user.id)}).then(function(r){e.deleteDialog=!1,e.dialog=!1,e.user=null,e.getUsers(),e.$toast.success(e.$t("message.DELETED_SUCCESSFULLY"))}).catch(function(r){e.$toast.error(e.$error(r,l))})},updatePhoto(e){var l=this;let r="ADMIN_EDIT_USER";this.staff&&(r="ADMIN_EDIT_STAFF"),this.$axios({method:this.$api(r).method,url:this.$api(r).url.replace("{pk}",this.user.id),data:e}).then(function(u){l.user=u.data.data}).catch(function(u){l.$toast.error(l.$error(u,r))})},deletePhoto(){this.updatePhoto({photo:null}),this.file=null},uploadPhoto(){this.$refs.fileInput.click()},handleFileChange(){if(this.file){let e=new FormData;e.append("photo",this.file),this.updatePhoto(e)}},save(){var e=this;let l="ADMIN_EDIT_USER",r={first_name:this.user.first_name,last_name:this.user.last_name,call_name:this.user.call_name,tel:this.user.tel,address:this.user.address,is_active:this.user.is_active};this.staff?(l="ADMIN_EDIT_STAFF",r.is_staff=this.user.is_staff):r.is_approved=this.user.is_approved,this.$axios({method:this.$api(l).method,url:this.$api(l).url.replace("{pk}",this.user.id),data:r}).then(function(u){e.user=u.data.data,e.$toast.success(e.$t("message.SAVED_SUCCESSFULLY"))}).catch(function(u){e.$toast.error(e.$error(u,l))})}}},X={key:0},Y={key:1},Q=["onClick"],W={class:"py-6 ml-10"},Z={class:"text-body-2 font-weight-medium"},ee={class:"text-body-2 font-weight-medium"},te={class:"text-body-2 font-weight-medium"},le={class:"text-body-2 font-weight-medium"},oe={class:"text-body-2 font-weight-medium"},se={class:"text-body-2 font-weight-medium"},ae={class:"text-body-2 font-weight-medium"},ie={class:"mr-8"},ne={class:"mr-8"},re={class:"mr-8"};function ue(e,l,r,u,s,c){const E=D("ActiveSelector"),k=D("NumberPagination");return s.init?(m(),h(x,{key:0},{default:o(()=>[t(p,{style:{"border-bottom":"1px solid #DEE1E6FF"}},{default:o(()=>[t(d,{class:"text-h5 font-weight-bold py-2"},{default:o(()=>[s.staff?(m(),g("span",X,i(e.$t("accounts.STAFFS")),1)):(m(),g("span",Y,i(e.$t("accounts.USERS")),1))]),_:1}),t(d,{class:"text-right py-2"},{default:o(()=>[t(V,{variant:"outlined","prepend-icon":"mdi-microsoft-excel",color:"secondary",disabled:s.staff,onClick:c.exportExcel},{default:o(()=>[f(i(e.$t("action.EXPORT")),1)]),_:1},8,["disabled","onClick"])]),_:1})]),_:1}),t(p,{class:"py-2"},{default:o(()=>[t(d,null,{default:o(()=>[t(q,{modelValue:s.staff,"onUpdate:modelValue":[l[0]||(l[0]=a=>s.staff=a),c.onTabUpdate],density:"comfortable",color:"secondary"},{default:o(()=>[t(A,{value:!1},{default:o(()=>[f(i(e.$t("accounts.USERS")),1)]),_:1}),t(A,{value:!0},{default:o(()=>[f(i(e.$t("accounts.STAFFS")),1)]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{class:"px-0"},{default:o(()=>[t(_,{modelValue:s.search,"onUpdate:modelValue":l[1]||(l[1]=a=>s.search=a),variant:"outlined",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",placeholder:e.$t("hint.SEARCH_USERNAME_NAME"),onKeydown:w(c.onEnter,["enter"])},null,8,["modelValue","placeholder","onKeydown"])]),_:1}),t(d,{cols:"2",class:"ml-1 pl-0 pr-3 hidden-sm-and-down"},{default:o(()=>[t(E,{modelValue:s.active,"onUpdate:modelValue":l[2]||(l[2]=a=>s.active=a),getItems:c.getUsers},null,8,["modelValue","getItems"])]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(d,null,{default:o(()=>[t(B,{density:"comfortable",hover:!0},{default:o(()=>[n("thead",null,[n("tr",null,[n("th",null,i(e.$t("common.ID")),1),n("th",null,i(e.$t("accounts.USERNAME")),1),n("th",null,i(e.$t("accounts.CALL_NAME")),1),n("th",null,i(e.$t("accounts.DATE_JOINED")),1),n("th",null,i(e.$t("accounts.LAST_LOGIN")),1),n("th",null,i(e.$t("common.ACTIVE")),1)])]),n("tbody",null,[(m(!0),g(M,null,R(s.users,a=>(m(),g("tr",{key:a.id,onClick:de=>c.editUser(a),style:{cursor:"pointer"}},[n("td",null,i(a.id),1),n("td",null,i(a.username),1),n("td",null,i(a.call_name),1),n("td",null,i(u.formatDate(a.date_joined)),1),n("td",null,i(u.formatDateTime(a.last_login)),1),n("td",null,[a.is_active?(m(),h(y,{key:0,icon:"mdi-check-circle-outline",color:"success"})):(m(),h(y,{key:1,icon:"mdi-close-circle-outline",color:"error"}))])],8,Q))),128))])]),_:1})]),_:1})]),_:1}),t(k,{modelValue:s.pageSize,"onUpdate:modelValue":l[3]||(l[3]=a=>s.pageSize=a),pagination:s.pagination,getItems:c.getUsers},null,8,["modelValue","pagination","getItems"]),s.user?(m(),h(T,{key:0,modelValue:s.dialog,"onUpdate:modelValue":l[16]||(l[16]=a=>s.dialog=a),"max-width":"500"},{default:o(()=>[t(v,{width:"100%",class:"mx-auto mt-3 pa-6 pt-2"},{default:o(()=>[t(K,{class:"mb-4 text-h6 font-weight-bold text-center"},{default:o(()=>[f(i(s.user.username),1)]),_:1}),t(G,{modelValue:s.validation,"onUpdate:modelValue":l[15]||(l[15]=a=>s.validation=a)},{default:o(()=>[t(p,null,{default:o(()=>[s.user.photo?(m(),h(v,{key:0,flat:"",class:"ml-3"},{default:o(()=>[t(z,{src:s.user.photo,width:"80",height:"80"},null,8,["src"])]),_:1})):(m(),h(v,{key:1,flat:"",width:"80",height:"80",class:"ml-3"},{default:o(()=>[t(y,{size:"x-large",class:"pa-10",icon:"mdi-account-outline"})]),_:1})),n("div",W,[t(V,{variant:"outlined",color:"secondary",onClick:c.uploadPhoto},{default:o(()=>[f(i(e.$t("accounts.UPLOAD_PHOTO")),1)]),_:1},8,["onClick"]),t(H,{modelValue:s.file,"onUpdate:modelValue":l[4]||(l[4]=a=>s.file=a),accept:"image/*",ref:"fileInput",onChange:c.handleFileChange,style:{display:"none"}},null,8,["modelValue","onChange"]),t(V,{variant:"text",color:"pale",class:"ml-4",onClick:c.deletePhoto},{default:o(()=>[f(i(e.$t("action.REMOVE")),1)]),_:1},8,["onClick"])])]),_:1}),t(p,{class:"mt-4"},{default:o(()=>[t(d,null,{default:o(()=>[n("div",Z,i(e.$t("accounts.FIRST_NAME")),1),t(_,{modelValue:s.user.first_name,"onUpdate:modelValue":l[5]||(l[5]=a=>s.user.first_name=a),density:"compact",rules:[u.rules.required]},null,8,["modelValue","rules"])]),_:1}),t(d,null,{default:o(()=>[n("div",ee,i(e.$t("accounts.LAST_NAME")),1),t(_,{modelValue:s.user.last_name,"onUpdate:modelValue":l[6]||(l[6]=a=>s.user.last_name=a),density:"compact",rules:[u.rules.required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(p,{class:"my-0"},{default:o(()=>[t(d,null,{default:o(()=>[n("div",te,i(e.$t("accounts.CALL_NAME")),1),t(_,{modelValue:s.user.call_name,"onUpdate:modelValue":l[7]||(l[7]=a=>s.user.call_name=a),density:"compact",rules:[u.rules.required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(p,{class:"my-0"},{default:o(()=>[t(d,null,{default:o(()=>[n("div",le,i(e.$t("accounts.TEL")),1),t(_,{modelValue:s.user.tel,"onUpdate:modelValue":l[8]||(l[8]=a=>s.user.tel=a),density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(p,{class:"my-0"},{default:o(()=>[t(d,null,{default:o(()=>[n("div",oe,i(e.$t("accounts.ADDRESS")),1),t(_,{modelValue:s.user.address,"onUpdate:modelValue":l[9]||(l[9]=a=>s.user.address=a),density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(p,{class:"my-0"},{default:o(()=>[t(d,null,{default:o(()=>[n("div",se,[f(i(e.$t("accounts.DATE_JOINED"))+" ",1),t(_,{placeholder:u.formatDate(s.user.date_joined),density:"compact",readonly:""},null,8,["placeholder"])])]),_:1})]),_:1}),t(p,{class:"my-0"},{default:o(()=>[t(d,null,{default:o(()=>[n("div",ae,[f(i(e.$t("accounts.LAST_LOGIN"))+" ",1),t(_,{placeholder:u.formatDateTime(s.user.last_login),density:"compact",readonly:""},null,8,["placeholder"])])]),_:1})]),_:1}),t(p,{class:"my-0"},{default:o(()=>[t(d,null,{default:o(()=>[t(S,{modelValue:s.user.is_active,"onUpdate:modelValue":l[10]||(l[10]=a=>s.user.is_active=a),color:"secondary"},{prepend:o(()=>[n("span",ie,i(e.$t("common.ACTIVE")),1)]),_:1},8,["modelValue"])]),_:1}),s.staff?(m(),h(d,{key:0},{default:o(()=>[t(S,{modelValue:s.user.is_staff,"onUpdate:modelValue":l[11]||(l[11]=a=>s.user.is_staff=a),color:"secondary"},{prepend:o(()=>[n("span",ne,i(e.$t("accounts.STAFF")),1)]),_:1},8,["modelValue"])]),_:1})):(m(),h(d,{key:1},{default:o(()=>[t(S,{modelValue:s.user.is_approved,"onUpdate:modelValue":l[12]||(l[12]=a=>s.user.is_approved=a),color:"secondary"},{prepend:o(()=>[n("span",re,i(e.$t("accounts.APPROVED")),1)]),_:1},8,["modelValue"])]),_:1}))]),_:1}),t(j,{class:"my-0 pa-0"},{default:o(()=>[t(V,{color:"secondary",block:"",disabled:!s.validation,onClick:c.save},{default:o(()=>[f(i(e.$t("action.SAVE")),1)]),_:1},8,["disabled","onClick"])]),_:1}),t(p,{class:"mt-2"},{default:o(()=>[t(C),t(T,{modelValue:s.deleteDialog,"onUpdate:modelValue":l[14]||(l[14]=a=>s.deleteDialog=a),"max-width":"400",persistent:""},{activator:o(({props:a})=>[s.user.is_active?(m(),h(V,P({key:0},a,{variant:"text",color:"pale",size:"small"}),{default:o(()=>[f(i(e.$t("action.DELETE_USER")),1)]),_:2},1040)):U("",!0)]),default:o(()=>[t(v,{title:e.$t("accounts.DELETE_USER"),text:e.$t("hint.DELETE_USER_DESCRIPTION")},{prepend:o(()=>[t(y,{icon:"mdi-alert",color:"secondary"})]),actions:o(()=>[t(C),t(V,{variant:"outlined",color:"pale",onClick:l[13]||(l[13]=a=>s.deleteDialog=!1)},{default:o(()=>[f(i(e.$t("action.CANCEL")),1)]),_:1}),t(V,{color:"secondary",onClick:c.deleteUser},{default:o(()=>[f(i(e.$t("action.DELETE_USER")),1)]),_:1},8,["onClick"])]),_:1},8,["title","text"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])):U("",!0)]),_:1})):(m(),h($,{key:1,indeterminate:"",height:4,color:"secondary"}))}const Oe=O(J,[["render",ue]]);export{Oe as default};
