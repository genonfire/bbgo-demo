import{N as V}from"./NumberPagination-a91fcdac.js";import{u as E}from"./datetime-87f6df03.js";import{u as k}from"./user-12dc24db.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import{V as w}from"./VContainer-e9bae796.js";import{V as d}from"./VCol-aa336778.js";import{V as g}from"./forwardRefs-540210a6.js";import{V as v}from"./VTooltip-8cd96291.js";import{V as T}from"./VRow-9dd703d4.js";import{V as R}from"./VTable-d95f7c4d.js";import{r as y,o as p,c as b,w as s,g as f,a as i,b as c,t as o,d as r,M as C,e as h,f as I,F as S,_ as q}from"./index-cd0f3d5b.js";import"./VSelect-ed41f246.js";import"./VTextField-3cacdb26.js";import"./VField-ffd0fbb4.js";import"./VMenu-9059ef23.js";import"./ssrBoot-8c3076c6.js";import"./VOverlay-891c21e4.js";import"./VCheckboxBtn-de07382e.js";import"./VChip-85d324e4.js";const A={setup(){const{formatDateOrTime:t}=E(),{username:l}=k();return{formatDateOrTime:t,username:l}},components:{NumberPagination:V},data(){return{forum:null,threads:[],pagination:null,pageSize:20,page:1,init:!1}},mounted(){this.$route.params.page&&(this.page=this.$route.params.page),this.getThreads(this.page,this.$route.query.q)},methods:{threadPage(t=1){this.$router.push({name:"thread.page",params:{forum:this.forum.name,page:t},query:{q:this.$route.query.q}})},getThreads(t=1,l=null){const m=this;let u="";l&&(u="&q="+l);let a=`${this.$api("THREAD_LIST").url}?page_size=${this.pageSize}&page=${t}${u}`;this.$axios({method:this.$api("THREAD_LIST").method,url:a.replace("{forum}",this.$route.params.forum)}).then(function(n){m.pagination=n.data.pagination,m.forum=n.data.data.forum,m.threads=n.data.data.threads,m.init=!0}).catch(function(n){m.$toast.error(m.$error(n,"THREAD_LIST"))})},newThread(){this.$router.push({name:"thread.write",params:{forum:this.$route.params.forum}})}}},N={class:"pl-2 text-body-2"},x={class:"text-center"},H={width:"120"},P={key:0,class:"font-weight-bold",style:{color:"#2384e2"}};function B(t,l,m,u,a,n){const _=y("router-link"),$=y("NumberPagination");return a.init?(p(),b(w,{key:0},{default:s(()=>[i(T,{style:{"border-bottom":"1px solid #DEE1E6FF"}},{default:s(()=>[i(d,{class:"text-h5 font-weight-bold py-2"},{default:s(()=>[i(_,{to:{name:"thread"}},{default:s(()=>[c(o(a.forum.title),1)]),_:1}),r("p",N,o(a.forum.description),1)]),_:1}),i(d,{cols:"3",class:"py-2 d-flex justify-end"},{default:s(()=>[i(g,{variant:"outlined","prepend-icon":"mdi-pencil-outline",color:"secondary",onClick:n.newThread,disabled:!a.forum.permissions.write},{default:s(()=>[c(o(t.$t("action.WRITE")),1)]),_:1},8,["onClick","disabled"]),t.$store.isStaff?(p(),b(v,{key:0,location:"bottom",text:t.$t("forum.THREAD_TRASH")},{activator:s(({props:e})=>[i(g,C(e,{icon:"mdi-trash-can-outline",density:"comfortable",variant:"text",color:"pale",class:"ml-1",onClick:l[0]||(l[0]=F=>t.$router.push({name:"thread.trash",params:{forum:a.forum.name}}))}),null,16)]),_:1},8,["text"])):f("",!0)]),_:1})]),_:1}),i(T,null,{default:s(()=>[i(d,null,{default:s(()=>[i(R,{density:"comfortable",hover:!0},{default:s(()=>[r("thead",null,[r("tr",null,[r("th",null,o(t.$t("common.PK")),1),r("th",x,o(t.$t("forum.THREAD_TITLE")),1),r("th",null,o(t.$t("forum.THREAD_USER")),1),r("th",H,o(t.$t("common.DATE")),1)])]),r("tbody",null,[(p(!0),h(S,null,I(a.threads,e=>(p(),h("tr",{key:e.id,class:q(e.is_pinned?"font-weight-bold":"")},[r("td",null,o(e.id),1),r("td",null,[i(_,{to:{name:"thread.read",params:{forum:a.forum.name,thread:e.id,title:e.title.replace(/ /g,"_")}}},{default:s(()=>[c(o(e.title)+" ",1),e.reply_count?(p(),h("span",P," ["+o(e.reply_count)+"] ",1)):f("",!0)]),_:2},1032,["to"])]),r("td",null,o(u.username(e)),1),r("td",null,o(u.formatDateOrTime(e.date_or_time)),1)],2))),128))])]),_:1})]),_:1})]),_:1}),i($,{pagination:a.pagination,getItems:n.threadPage,page:parseInt(a.page)},null,8,["pagination","getItems","page"])]),_:1})):f("",!0)}const st=D(A,[["render",B],["__scopeId","data-v-f94ccefa"]]);export{st as default};
